let e="Stream Weather",n={},t={},a="",o=1920,r=1080,i=.5;function s(e){return Math.floor(Math.random()*Math.floor(e))}window.setupGame=function(s,l,c){e=s,n=l,t=c,a=n.path||"",t.clouds=void 0===t.clouds||null===t.clouds?!t.overlay:"true"===t.clouds,i=void 0===t.volume||null===t.volume?0:parseInt(t.volume)/100,o=Math.min(window.innerWidth,1920),r=Math.min(window.innerHeight,1080)},window.WebFontConfig={custom:{families:["Pixeltype"]},active(){!async function(){try{const e=(await fetch(`${a}/assets/shamelist.txt`).then((e=>e.text()))).split(",").map((e=>e.trim().toLowerCase()));t.channel&&e&&e.includes(t.channel.toLowerCase())&&(console.log("This channel has been blocked for violating the PixelPlush Terms of Service."),!1)}catch(e){console.log(e)}if(Unicorn.Create("unicorn-display",{width:o,height:r,background:"transparent",init:C,update:$,channel:t.channel,username:t.oauth?t.channel:void 0,password:t.oauth,onCommand:h,onChat:u,screenWalls:!1,gravity:{x:0,y:0}}),ComfyJS.onCheer=m,ComfyJS.onConnected=async(e,n,t)=>{if(t){let e=await ComfyJS.GetChannelRewards(l,!0),n=Object.keys(c);for(let t=0;t<n.length;t++){let a=n[t];e.some((e=>e.title===a))||await ComfyJS.CreateChannelReward(l,{title:a,prompt:c[a].desc,cost:c[a].cost,is_enabled:!0,background_color:c[a].color,is_user_input_required:!1,is_max_per_stream_enabled:!1,max_per_stream:0,is_max_per_user_per_stream_enabled:!1,max_per_user_per_stream:0,is_global_cooldown_enabled:!0,global_cooldown_seconds:c[a].cooldown,should_redemptions_skip_request_queue:!0})}}},ComfyJS.onReward=(e,n,t,a)=>{c[n]&&c[n].callback()},t.oauth){let e=await async function(e){return await fetch("https://id.twitch.tv/oauth2/validate",{headers:{Authorization:`OAuth ${e}`}}).then((e=>e.json())).catch((e=>({error:e})))}(t.oauth);l=e.client_id,["user:read:email","chat:read","chat:edit","channel:manage:redemptions","channel:read:redemptions"].every((n=>e.scopes.includes(n)))||console.log("Need more permissions"),e.expires_in<1800&&console.log("Token expires soon. Need to generate new link")}}()}},function(){const e=document.createElement("script");e.src=("https:"===document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",e.type="text/javascript",e.async="true";const n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}();let l="";const c={"Make It Rain!":{desc:"Bring the rains down from Africa!",color:"#00E5CB",cost:1,cooldown:1,callback:()=>{f(5)}},"HEAVY RAIN!":{desc:"Lots and strong rains",color:"#00E5CB",cost:1,cooldown:3,callback:()=>{g(5)}},"Lightning BZZT!":{desc:"Flash of lightning!",color:"#00E5CB",cost:1,cooldown:30,callback:()=>{w()}},"Rainbow!!!":{desc:"Colors colors everywhere!",color:"#00E5CB",cost:1,cooldown:30,callback:()=>{y()}},"Make It Shine!!":{desc:"Let there be light!",color:"#00E5CB",cost:1,cooldown:30,callback:()=>{b()}}};let d=0;async function h(e,n,t,a,o){if(!document.hidden){if((a.broadcaster||a.mod)&&"resetweather"===n){let e=await ComfyJS.GetChannelRewards(l,!0),n=Object.keys(c);for(let t=0;t<n.length;t++){let a=n[t],o=e.find((e=>e.title===a));o&&await ComfyJS.DeleteChannelReward(l,o.id)}location.reload()}if((a.broadcaster||a.mod)&&"deleteweather"===n){let e=await ComfyJS.GetChannelRewards(l,!0),n=Object.keys(c);for(let t=0;t<n.length;t++){let a=n[t],o=e.find((e=>e.title===a));o&&await ComfyJS.DeleteChannelReward(l,o.id)}}(a.broadcaster||a.mod||a.vip)&&"rain"===n&&f(parseInt(t||5)),(a.broadcaster||a.mod||a.vip)&&"heavyrain"===n&&g(parseInt(t||5)),(a.broadcaster||a.mod||a.vip)&&"lightning"===n&&w(),(a.broadcaster||a.mod||a.vip)&&"rainbow"===n&&y(),(a.broadcaster||a.mod||a.vip)&&"sunrays"===n&&b()}}function u(e,n,t,a,o){document.hidden}function m(e,n,t,a,o){document.hidden}let p={},_={};function f(e){for(let n=0;n<e;n++)for(let e=0;e<30;e++)setTimeout((()=>{v("raindrop",s(1920))}),s(1e3)+1e3*n)}function w(){v("lightning",0)}function g(e){for(let n=0;n<e;n++)for(let e=0;e<50;e++)setTimeout((()=>{v(`heavy_rain_${s(5)+1}`,s(3840)-960)}),s(1e3)+1e3*n)}function y(){v("rainbow",0)}function b(){v("sunrays",0)}function v(e,n){d++;let t="particle_"+d,a=Unicorn.AddObject(t,{type:"rectangle",scale:{x:3,y:3},animations:{anim:{framerate:_[e],frames:p[e].slice(),loop:!1}},isStatic:!0,x:n,y:0,z:100});"rainbow"!==e&&"sunrays"!==e&&(a.animations.anim.alpha=.5),a.animations.anim.anchor.set(0),setTimeout((()=>{Unicorn.RemoveObject(t)}),.25*_[e]*p[e].length*1e3)}function C(){PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST;for(let e=1;e<=5;e++){p[`heavy_rain_${e}`]=[],_[`heavy_rain_${e}`]=16/60;for(let n=0;n<12;n++)Unicorn.Load(`heavy_rain_${e}_${n}`,`${a}/assets/stream-weather/heavy_rain/heavy_rain_${e}/heavy_rain_${e}_${n+1}.png`),p[`heavy_rain_${e}`].push(`heavy_rain_${e}_${n}`)}p.lightning=[],_.lightning=16/60;for(let e=0;e<4;e++)Unicorn.Load(`lightning_${e}`,`${a}/assets/stream-weather/lightning/lightning${e+1}.png`),p.lightning.push(`lightning_${e}`);p.raindrop=[],_.raindrop=16/60;for(let e=0;e<10;e++)Unicorn.Load(`raindrop_${e}`,`${a}/assets/stream-weather/raindrop/raindrop${e+1}.png`),p.raindrop.push(`raindrop_${e}`);p.rainbow=[],_.rainbow=16/60;for(let e=0;e<26;e++)Unicorn.Load(`rainbow_${e}`,`${a}/assets/stream-weather/rainbow/rainbow${e}.png`),p.rainbow.push(`rainbow_${e}`);p.sunrays=[],_.sunrays=16/60;for(let e=0;e<40;e++)Unicorn.Load(`sunrays_${e}`,`${a}/assets/stream-weather/sunrays/sunrays${e}.png`),p.sunrays.push(`sunrays_${e}`)}function $(e,n){}