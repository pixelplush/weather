let e="Stream Weather",t={},n={},o="",a=1920,i=1080,r=.5;function l(e){return Math.floor(Math.random()*Math.floor(e))}window.setupGame=function(l,s,c){e=l,t=s,n=c,o=t.path||"",n.clouds=void 0===n.clouds||null===n.clouds?!n.overlay:"true"===n.clouds,r=void 0===n.volume||null===n.volume?0:parseInt(n.volume)/100,a=Math.min(window.innerWidth,1920),i=Math.min(window.innerHeight,1080)},window.WebFontConfig={custom:{families:["Pixeltype"]},active(){!async function(){try{const e=(await fetch(`${o}/assets/shamelist.txt`).then((e=>e.text()))).split(",").map((e=>e.trim().toLowerCase()));n.channel&&e&&e.includes(n.channel.toLowerCase())&&(console.log("This channel has been blocked for violating the PixelPlush Terms of Service."),!1)}catch(e){console.log(e)}if(Unicorn.Create("unicorn-display",{width:a,height:i,background:0,init:v,update:b,channel:n.channel,username:n.oauth?n.channel:void 0,password:n.oauth,onCommand:h,onChat:m,screenWalls:!1,gravity:{x:0,y:0}}),ComfyJS.onCheer=u,ComfyJS.onConnected=async(e,t,n)=>{if(n){let e=await ComfyJS.GetChannelRewards(s,!0);console.log(e);let t=Object.keys(c);for(let n=0;n<t.length;n++){let o=t[n];e.some((e=>e.title===o))||await ComfyJS.CreateChannelReward(s,{title:o,prompt:c[o].desc,cost:c[o].cost,is_enabled:!0,background_color:c[o].color,is_user_input_required:!1,is_max_per_stream_enabled:!1,max_per_stream:0,is_max_per_user_per_stream_enabled:!1,max_per_user_per_stream:0,is_global_cooldown_enabled:!0,global_cooldown_seconds:c[o].cooldown,should_redemptions_skip_request_queue:!0})}}},ComfyJS.onReward=(e,t,n,o)=>{c[t]&&c[t].callback()},n.oauth){let e=await async function(e){return await fetch("https://id.twitch.tv/oauth2/validate",{headers:{Authorization:`OAuth ${e}`}}).then((e=>e.json())).catch((e=>({error:e})))}(n.oauth);["user:read:email","chat:read","chat:edit","channel:manage:redemptions","channel:read:redemptions"].every((t=>e.scopes.includes(t)))||console.log("Need more permissions"),e.expires_in<1800&&console.log("Token expires soon. Need to generate new link")}}()}},function(){const e=document.createElement("script");e.src=("https:"===document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",e.type="text/javascript",e.async="true";const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();const s="r6b6h6qgvtg9jmr8rfvdn3oovgjij7",c={"Make It Rain!":{desc:"Bring the rains down from Africa!",color:"#00E5CB",cost:1,cooldown:1,callback:()=>{_(5)}},"HEAVY RAIN!":{desc:"Lots and strong rains",color:"#00E5CB",cost:1,cooldown:3,callback:()=>{w(5)}},"Lightning BZZT!":{desc:"Flash of lightning!",color:"#00E5CB",cost:1,cooldown:30,callback:()=>{g()}}};let d=0;async function h(e,t,n,o,a){if(!document.hidden){if((o.broadcaster||o.mod)&&"resetweather"===t){let e=await ComfyJS.GetChannelRewards(s,!0),t=Object.keys(c);for(let n=0;n<t.length;n++){let o=t[n],a=e.find((e=>e.title===o));a&&await ComfyJS.DeleteChannelReward(s,a.id)}location.reload()}if((o.broadcaster||o.mod)&&"deleteweather"===t){let e=await ComfyJS.GetChannelRewards(s,!0),t=Object.keys(c);for(let n=0;n<t.length;n++){let o=t[n],a=e.find((e=>e.title===o));a&&await ComfyJS.DeleteChannelReward(s,a.id)}}(o.broadcaster||o.mod||o.vip)&&"rain"===t&&_(parseInt(n||5)),(o.broadcaster||o.mod||o.vip)&&"heavyrain"===t&&w(parseInt(n||5)),(o.broadcaster||o.mod||o.vip)&&"lightning"===t&&g()}}function m(e,t,n,o,a){document.hidden}function u(e,t,n,o,a){document.hidden}let p={},f={};function _(e){for(let t=0;t<e;t++)for(let e=0;e<30;e++)setTimeout((()=>{y("raindrop",l(1920))}),l(1e3)+1e3*t)}function g(){y("lightning",0)}function w(e){for(let t=0;t<e;t++)for(let e=0;e<50;e++)setTimeout((()=>{y(`heavy_rain_${l(5)+1}`,l(3840)-960)}),l(1e3)+1e3*t)}function y(e,t){d++;let n="particle_"+d,o=Unicorn.AddObject(n,{type:"rectangle",scale:{x:3,y:3},animations:{anim:{framerate:f[e],frames:p[e].slice(),loop:!1}},isStatic:!0,x:t,y:0,z:100});console.log(o),o.animations.anim.alpha=.5,o.animations.anim.anchor.set(0),setTimeout((()=>{Unicorn.RemoveObject(n)}),.25*f[e]*p[e].length*1e3)}function v(){PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST;for(let e=1;e<=5;e++){p[`heavy_rain_${e}`]=[],f[`heavy_rain_${e}`]=16/60;for(let t=0;t<12;t++)Unicorn.Load(`heavy_rain_${e}_${t}`,`${o}/assets/stream-weather/heavy_rain/heavy_rain_${e}/heavy_rain_${e}_${t+1}.png`),p[`heavy_rain_${e}`].push(`heavy_rain_${e}_${t}`)}p.lightning=[],f.lightning=16/60;for(let e=0;e<4;e++)Unicorn.Load(`lightning_${e}`,`${o}/assets/stream-weather/lightning/lightning${e+1}.png`),p.lightning.push(`lightning_${e}`);p.raindrop=[],f.raindrop=16/60;for(let e=0;e<10;e++)Unicorn.Load(`raindrop_${e}`,`${o}/assets/stream-weather/raindrop/raindrop${e+1}.png`),p.raindrop.push(`raindrop_${e}`)}function b(e,t){}